"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const replace_and_inject_1 = __importDefault(require("./tsjs/replace-and-inject"));
const loader = function (source, sourceMap) {
    const file = this.resourcePath;
    const opts = this.query;
    // console.log(file);
    const cb = this.async();
    try {
        const replaced = (0, replace_and_inject_1.default)(file, source, opts.injector, opts.tsConfigFile, opts.compileExpContext ? opts.compileExpContext(file) : {});
        cb(null, replaced, sourceMap);
    }
    catch (e) {
        console.error('[webpack-common.ts-loader]processing: ' + file, e);
        return cb(e);
    }
};
exports.default = loader;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHMtbG9hZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsidHMtbG9hZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsbUZBQXlEO0FBU3pELE1BQU0sTUFBTSxHQUFxQixVQUFTLE1BQU0sRUFBRSxTQUFTO0lBQ3pELE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7SUFDL0IsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQWdCLENBQUM7SUFDbkMscUJBQXFCO0lBQ3JCLE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUN4QixJQUFJO1FBQ0YsTUFBTSxRQUFRLEdBQUcsSUFBQSw0QkFBZ0IsRUFBQyxJQUFJLEVBQUUsTUFBZ0IsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxZQUFZLEVBQ3hGLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUM5RCxFQUFHLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxTQUFTLENBQUMsQ0FBQztLQUNoQztJQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ1YsT0FBTyxDQUFDLEtBQUssQ0FBQyx3Q0FBd0MsR0FBRyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDbEUsT0FBTyxFQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDZjtBQUNILENBQUMsQ0FBQztBQUVGLGtCQUFlLE1BQU0sQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHdwIGZyb20gJ3dlYnBhY2snO1xuaW1wb3J0IHJlcGxhY2VBbmRJbmplY3QgZnJvbSAnLi90c2pzL3JlcGxhY2UtYW5kLWluamVjdCc7XG5pbXBvcnQgUkogZnJvbSAncmVxdWlyZS1pbmplY3Rvcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3B0aW9ucyB7XG4gIHRzQ29uZmlnRmlsZTogc3RyaW5nO1xuICBpbmplY3RvcjogUko7XG4gIGNvbXBpbGVFeHBDb250ZXh0PzogKHNvdXJjZUZpbGU6IHN0cmluZykgPT4ge1t2YXJOYW1lOiBzdHJpbmddOiBhbnl9O1xufVxuXG5jb25zdCBsb2FkZXI6IHdwLmxvYWRlci5Mb2FkZXIgPSBmdW5jdGlvbihzb3VyY2UsIHNvdXJjZU1hcCkge1xuICBjb25zdCBmaWxlID0gdGhpcy5yZXNvdXJjZVBhdGg7XG4gIGNvbnN0IG9wdHMgPSB0aGlzLnF1ZXJ5IGFzIE9wdGlvbnM7XG4gIC8vIGNvbnNvbGUubG9nKGZpbGUpO1xuICBjb25zdCBjYiA9IHRoaXMuYXN5bmMoKTtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXBsYWNlZCA9IHJlcGxhY2VBbmRJbmplY3QoZmlsZSwgc291cmNlIGFzIHN0cmluZywgb3B0cy5pbmplY3Rvciwgb3B0cy50c0NvbmZpZ0ZpbGUsXG4gICAgICBvcHRzLmNvbXBpbGVFeHBDb250ZXh0ID8gb3B0cy5jb21waWxlRXhwQ29udGV4dChmaWxlKSA6IHt9KTtcbiAgICBjYiEobnVsbCwgcmVwbGFjZWQsIHNvdXJjZU1hcCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbd2VicGFjay1jb21tb24udHMtbG9hZGVyXXByb2Nlc3Npbmc6ICcgKyBmaWxlLCBlKTtcbiAgICByZXR1cm4gY2IhKGUpO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBsb2FkZXI7XG4iXX0=