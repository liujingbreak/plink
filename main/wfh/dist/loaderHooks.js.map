{"version":3,"file":"loaderHooks.js","sourceRoot":"","sources":["../ts/loaderHooks.ts"],"names":[],"mappings":";AAAA,6KAA6K;AAC7K;;GAEG;;;;AAEH,qCAAqC;AACrC,SAAS;AACT,IAAI;AACJ,4DAA4B;AAG5B;;GAEG;AACH,SAAgB,mBAAmB,CAAC,IAK5B;IAEN,MAAM,QAAQ,GAAG,gBAAM,CAAC,SAAS,CAAC,OAAO,CAAC;IAC1C,gBAAM,CAAC,SAAS,CAAC,OAAO,GAAG,UAAuB,MAAc;QAC9D,MAAM,YAAY,GAAG,GAAG,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QACvD,MAAM,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,MAAM,EAAE,YAAY,EACvD,CAAC,aAAa,EAAE,OAAO,EAAE,EAAE,CAAE,gBAAc,CAAC,gBAAgB,CAAC,aAAa,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC;QACrG,OAAO,QAAQ,KAAK,SAAS,CAAC,CAAC,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC;IAC5D,CAAQ,CAAC;AACX,CAAC;AAdD,kDAcC","sourcesContent":["/* eslint-disable @typescript-eslint/no-unsafe-assignment,@typescript-eslint/no-unsafe-return,@typescript-eslint/no-unsafe-member-access,@typescript-eslint/no-unsafe-call */\n/**\n * Hack Node.js common module resolve process\n */\n\n// export interface CmjHookFunction {\n//   (): \n// }\nimport Module from 'module';\n\n\n/**\n * Hook into Node.js common JS module require function\n */\nexport function hookCommonJsRequire(hook: (\n  filename: string,\n  target: string,\n  originRequire: () => any,\n  resolve: (id: string, options?: { paths?: string[] }) => string\n) => any\n) {\n  const superReq = Module.prototype.require;\n  Module.prototype.require = function(this: Module, target: string) {\n    const callSuperReq = () => superReq.call(this, target);\n    const exported = hook(this.filename, target, callSuperReq,\n      (resolveTarget, options) => (Module as any)._resolveFilename(resolveTarget, this, false, options));\n    return exported === undefined ? callSuperReq() : exported;\n  } as any;\n}\n"]}