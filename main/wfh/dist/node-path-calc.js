"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.calcNodePaths = void 0;
const path_1 = __importDefault(require("path"));
const lodash_1 = __importDefault(require("lodash"));
function calcNodePaths(rootDir, symlinksDir, cwd, plinkDir) {
    const nodePaths = [path_1.default.resolve(rootDir, 'node_modules')];
    if (symlinksDir) {
        nodePaths.unshift(symlinksDir);
    }
    if (rootDir !== cwd) {
        nodePaths.unshift(path_1.default.resolve(cwd, 'node_modules'));
    }
    /**
     * Somehow when I install @wfh/plink in an new directory, npm does not dedupe dependencies from
     * @wfh/plink/node_modules directory up to current node_modules directory, results in MODULE_NOT_FOUND
     * from @wfh/plink/redux-toolkit-abservable for rxjs
     */
    nodePaths.push(plinkDir + path_1.default.sep + 'node_modules');
    if (process.env.NODE_PATH) {
        for (const path of process.env.NODE_PATH.split(path_1.default.delimiter)) {
            nodePaths.push(path);
        }
    }
    return lodash_1.default.uniq(nodePaths);
}
exports.calcNodePaths = calcNodePaths;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZS1wYXRoLWNhbGMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi90cy9ub2RlLXBhdGgtY2FsYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxnREFBd0I7QUFDeEIsb0RBQXVCO0FBRXZCLFNBQWdCLGFBQWEsQ0FBQyxPQUFlLEVBQUUsV0FBMEIsRUFBRSxHQUFXLEVBQUUsUUFBZ0I7SUFDdEcsTUFBTSxTQUFTLEdBQWEsQ0FBQyxjQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDO0lBQ3BFLElBQUksV0FBVyxFQUFFO1FBQ2YsU0FBUyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztLQUNoQztJQUNELElBQUksT0FBTyxLQUFLLEdBQUcsRUFBRTtRQUNuQixTQUFTLENBQUMsT0FBTyxDQUFDLGNBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLGNBQWMsQ0FBQyxDQUFDLENBQUM7S0FDdEQ7SUFFRDs7OztPQUlHO0lBQ0gsU0FBUyxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsY0FBSSxDQUFDLEdBQUcsR0FBRyxjQUFjLENBQUMsQ0FBQztJQUNyRCxJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFO1FBQ3pCLEtBQUssTUFBTSxJQUFJLElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLGNBQUksQ0FBQyxTQUFTLENBQUMsRUFBRTtZQUM5RCxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3RCO0tBQ0Y7SUFFRCxPQUFPLGdCQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzNCLENBQUM7QUF0QkQsc0NBc0JDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuXG5leHBvcnQgZnVuY3Rpb24gY2FsY05vZGVQYXRocyhyb290RGlyOiBzdHJpbmcsIHN5bWxpbmtzRGlyOiBzdHJpbmcgfCBudWxsLCBjd2Q6IHN0cmluZywgcGxpbmtEaXI6IHN0cmluZykge1xuICBjb25zdCBub2RlUGF0aHM6IHN0cmluZ1tdID0gW1BhdGgucmVzb2x2ZShyb290RGlyLCAnbm9kZV9tb2R1bGVzJyldO1xuICBpZiAoc3ltbGlua3NEaXIpIHtcbiAgICBub2RlUGF0aHMudW5zaGlmdChzeW1saW5rc0Rpcik7XG4gIH1cbiAgaWYgKHJvb3REaXIgIT09IGN3ZCkge1xuICAgIG5vZGVQYXRocy51bnNoaWZ0KFBhdGgucmVzb2x2ZShjd2QsICdub2RlX21vZHVsZXMnKSk7XG4gIH1cblxuICAvKipcbiAgICogU29tZWhvdyB3aGVuIEkgaW5zdGFsbCBAd2ZoL3BsaW5rIGluIGFuIG5ldyBkaXJlY3RvcnksIG5wbSBkb2VzIG5vdCBkZWR1cGUgZGVwZW5kZW5jaWVzIGZyb20gXG4gICAqIEB3ZmgvcGxpbmsvbm9kZV9tb2R1bGVzIGRpcmVjdG9yeSB1cCB0byBjdXJyZW50IG5vZGVfbW9kdWxlcyBkaXJlY3RvcnksIHJlc3VsdHMgaW4gTU9EVUxFX05PVF9GT1VORFxuICAgKiBmcm9tIEB3ZmgvcGxpbmsvcmVkdXgtdG9vbGtpdC1hYnNlcnZhYmxlIGZvciByeGpzXG4gICAqL1xuICBub2RlUGF0aHMucHVzaChwbGlua0RpciArIFBhdGguc2VwICsgJ25vZGVfbW9kdWxlcycpO1xuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9QQVRIKSB7XG4gICAgZm9yIChjb25zdCBwYXRoIG9mIHByb2Nlc3MuZW52Lk5PREVfUEFUSC5zcGxpdChQYXRoLmRlbGltaXRlcikpIHtcbiAgICAgIG5vZGVQYXRocy5wdXNoKHBhdGgpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBfLnVuaXEobm9kZVBhdGhzKTtcbn1cbiJdfQ==