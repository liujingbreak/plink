"use strict";
/* eslint-disable @typescript-eslint/no-unsafe-assignment,@typescript-eslint/no-unsafe-return,@typescript-eslint/no-unsafe-member-access,@typescript-eslint/no-unsafe-call */
/**
 * Hack Node.js common module resolve process
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.hookCommonJsRequire = void 0;
// export interface CmjHookFunction {
//   (): 
// }
const module_1 = __importDefault(require("module"));
/**
 * Hook into Node.js common JS module require function
 */
function hookCommonJsRequire(hook) {
    const superReq = module_1.default.prototype.require;
    module_1.default.prototype.require = function (target) {
        const callSuperReq = () => superReq.call(this, target);
        const exported = hook(this.filename, target, callSuperReq, (resolveTarget, options) => module_1.default._resolveFilename(resolveTarget, this, false, options));
        return exported === undefined ? callSuperReq() : exported;
    };
}
exports.hookCommonJsRequire = hookCommonJsRequire;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9hZGVySG9va3MuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi90cy9sb2FkZXJIb29rcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsNktBQTZLO0FBQzdLOztHQUVHOzs7Ozs7QUFFSCxxQ0FBcUM7QUFDckMsU0FBUztBQUNULElBQUk7QUFDSixvREFBNEI7QUFHNUI7O0dBRUc7QUFDSCxTQUFnQixtQkFBbUIsQ0FBQyxJQUs1QjtJQUVOLE1BQU0sUUFBUSxHQUFHLGdCQUFNLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQztJQUMxQyxnQkFBTSxDQUFDLFNBQVMsQ0FBQyxPQUFPLEdBQUcsVUFBdUIsTUFBYztRQUM5RCxNQUFNLFlBQVksR0FBRyxHQUFHLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztRQUN2RCxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUN2RCxDQUFDLGFBQWEsRUFBRSxPQUFPLEVBQUUsRUFBRSxDQUFFLGdCQUFjLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQztRQUNyRyxPQUFPLFFBQVEsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7SUFDNUQsQ0FBUSxDQUFDO0FBQ1gsQ0FBQztBQWRELGtEQWNDIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hc3NpZ25tZW50LEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtcmV0dXJuLEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2VzcyxAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWNhbGwgKi9cbi8qKlxuICogSGFjayBOb2RlLmpzIGNvbW1vbiBtb2R1bGUgcmVzb2x2ZSBwcm9jZXNzXG4gKi9cblxuLy8gZXhwb3J0IGludGVyZmFjZSBDbWpIb29rRnVuY3Rpb24ge1xuLy8gICAoKTogXG4vLyB9XG5pbXBvcnQgTW9kdWxlIGZyb20gJ21vZHVsZSc7XG5cblxuLyoqXG4gKiBIb29rIGludG8gTm9kZS5qcyBjb21tb24gSlMgbW9kdWxlIHJlcXVpcmUgZnVuY3Rpb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhvb2tDb21tb25Kc1JlcXVpcmUoaG9vazogKFxuICBmaWxlbmFtZTogc3RyaW5nLFxuICB0YXJnZXQ6IHN0cmluZyxcbiAgb3JpZ2luUmVxdWlyZTogKCkgPT4gYW55LFxuICByZXNvbHZlOiAoaWQ6IHN0cmluZywgb3B0aW9ucz86IHsgcGF0aHM/OiBzdHJpbmdbXSB9KSA9PiBzdHJpbmdcbikgPT4gYW55XG4pIHtcbiAgY29uc3Qgc3VwZXJSZXEgPSBNb2R1bGUucHJvdG90eXBlLnJlcXVpcmU7XG4gIE1vZHVsZS5wcm90b3R5cGUucmVxdWlyZSA9IGZ1bmN0aW9uKHRoaXM6IE1vZHVsZSwgdGFyZ2V0OiBzdHJpbmcpIHtcbiAgICBjb25zdCBjYWxsU3VwZXJSZXEgPSAoKSA9PiBzdXBlclJlcS5jYWxsKHRoaXMsIHRhcmdldCk7XG4gICAgY29uc3QgZXhwb3J0ZWQgPSBob29rKHRoaXMuZmlsZW5hbWUsIHRhcmdldCwgY2FsbFN1cGVyUmVxLFxuICAgICAgKHJlc29sdmVUYXJnZXQsIG9wdGlvbnMpID0+IChNb2R1bGUgYXMgYW55KS5fcmVzb2x2ZUZpbGVuYW1lKHJlc29sdmVUYXJnZXQsIHRoaXMsIGZhbHNlLCBvcHRpb25zKSk7XG4gICAgcmV0dXJuIGV4cG9ydGVkID09PSB1bmRlZmluZWQgPyBjYWxsU3VwZXJSZXEoKSA6IGV4cG9ydGVkO1xuICB9IGFzIGFueTtcbn1cbiJdfQ==