{"version":3,"file":"markdown-processor-main.js","sourceRoot":"","sources":["markdown-processor-main.ts"],"names":[],"mappings":";;;;AAAA,mDAAsC;AACtC,wDAAwB;AACxB,oDAAoB;AACpB,2FAAsF;AACtF,sCAAoC;AACpC,6DAAuD;AAuB/C,kGAvBA,sCAAiB,OAuBA;AArBzB,MAAM,GAAG,GAAG,IAAA,gBAAQ,EAAC,UAAU,CAAC,CAAC;AAEjC,SAAgB,WAAW,CAAC,mBAAmB,GAAG,KAAK,EAAE,cAAuB;IAC9E,MAAM,MAAM,GAAG,IAAA,uCAAkB,EAAC,sCAAiB,EAAE;QACnD,IAAI,EAAE,QAAQ;QACd,cAAc,EAAE,cAAc,aAAd,cAAc,cAAd,cAAc,GAAI,YAAE,CAAC,oBAAoB,EAAE;QAC3D,iBAAiB,EAAE,IAAI;QACvB,KAAK,EAAE,IAAI;QACX,mBAAmB;QACnB,GAAG,CAAC,GAAG,IAAW;YAChB,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC;QACpB,CAAC;QACD,QAAQ,EAAE,SAAS;QACnB,aAAa;YACX,OAAO,IAAI,uBAAM,CAAC,cAAI,CAAC,OAAO,CAAC,SAAS,EAAE,sCAAsC,CAAC,CAAC,CAAC;QACrF,CAAC;KACF,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;AAChB,CAAC;AAjBD,kCAiBC","sourcesContent":["import {Worker} from 'worker_threads';\nimport Path from 'path';\nimport os from 'os';\nimport {setupForMainWorker} from '@wfh/reactivizer/dist/fork-join/node-worker-broker';\nimport {log4File} from '@wfh/plink';\nimport {markdownProcessor} from './markdown-processor';\n\nconst log = log4File(__filename);\n\nexport function setupBroker(excludeCurrentThead = false, maxNumOfWorker?: number) {\n  const broker = setupForMainWorker(markdownProcessor, {\n    name: 'broker',\n    maxNumOfWorker: maxNumOfWorker ?? os.availableParallelism(),\n    threadMaxIdleTime: 4000,\n    debug: true,\n    excludeCurrentThead,\n    log(...args: [any]) {\n      log.info(...args);\n    },\n    logStyle: 'noParam',\n    workerFactory() {\n      return new Worker(Path.resolve(__dirname, '../dist/markdown-processor-worker.js'));\n    }\n  });\n\n  return broker;\n}\n\nexport {markdownProcessor};\n"]}